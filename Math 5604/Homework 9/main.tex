\documentclass{homework}
\input{../../standardcmd.tex}
\input{../homework_shared.tex}

\usepackage{listings}
\usepackage{booktabs}

\newcommand{\hwnum}{9}
\renewcommand{\questiontype}{Problem}

\begin{document}
	\maketitle
	
	Consider the 1D heat equation
	\begin{equation*}
		u_t = \frac{1}{2}u_{xx} + f(x,t), \qquad 0 < x < 1, \;t > 0,
	\end{equation*}
	with source term
	\begin{equation*}
		f(x,t) = \left(\frac{\pi^2}{2}-1\right)\sin\left(\pi\left(x+\frac{1}{2}\right)\right)
	\end{equation*}
	and Dirichlet boundary conditions given by
	\begin{equation*}
		u(0,t) = e^{-t}, \qquad u(1,t) = -e^{-t}, \qquad t > 0
	\end{equation*}
	and initial condition
	\begin{equation*}
		u(x,0) = \sin\left(\pi\left(x+\frac{1}{2}\right)\right), \qquad 0\le x\le 1.
	\end{equation*}
	The exact solution is $u(x,t) = e^{-t}\sin\left(\pi\left(x+\frac{1}{2}\right)\right)$.
	
	\question
	
	\begin{alphaparts}
		\questionpart
		Discretizing this equation on the time interval $[0,1]$ using a central difference method in space and the forward Euler method in time with the space sample points $x_i = ih$ for $i =0,1,\dots, M$ and time sample points $t_n = nk$ for $n=0,1,\dots N$, where $h = \frac{1}{M}$, and $k = \frac{1}{N}$, we obtain
		\begin{align*}
			\frac{u^n_{i+1} - u^n_i}{k} &= \frac{1}{2}\cdot\frac{u^n_{i-1}-2u^n_i + u^n_{i+1}}{h^2} + f(x_i,t_n), \qquad i =1,2,\dots, M-1, \; n = 0,1,\dots, N-1,\\
			u^n_0 &= e^{-t_n}, \quad u^n_{M} = -e^{-t_n}, \qquad n = 0,1,\dots, N,\\
			u^0_i &= \sin\left(\pi\left(x+\frac{1}{2}\right)\right), \qquad i = 0,1,\dots, M.
		\end{align*}
		where $u^n_i \approx u(x_i, t_n)$. We can rewrite this system as
		\begin{equation*}
			U^{n+1} = U^n + k(AU^n + b^n),
		\end{equation*}
		where
		\begin{equation*}
			U^n = \left[\begin{matrix}u^n_1 \\ u^n_2 \\ \vdots \\ u^n_{M-1}\end{matrix}\right], \qquad A = \frac{1}{2h^2}\left[\begin{matrix}
				-2 & 1 \\
				1 & -2 & 1 \\ 
				& & \ddots \\
				& & 1 & -2 & 1 \\
				& & & 1 - 2
			\end{matrix}\right], \qquad
			b^n = \left[\begin{matrix}
				f(x_1,t_n) + \frac{e^{-t_n}}{2h^2} \\
				f(x_2,t_n) \\
				\vdots
				\\
				f(x_{M-2}, t_n) \\
				f(x_{M-1}, t_n) - \frac{e^{-t_n}}{2h^2}
			\end{matrix}\right].
		\end{equation*}
		This linear recurrence is implemented in \verb*|problem.m| using a simple for loop.
		
		\questionpart The forward Euler method is unstable if $k > ch^2$ for some constant $c$. We determine this constant empirically to be roughly $1$ by using the bisection method in \verb*|stability_test.m|. By setting $h^2$ a little bit larger than $k$, we can still see the first-order convergence in $k$; see Table \ref{table:euler_time}.
		
		Observing second-order convergence in space is easier given the constraint $k < h^2$. We simply calculate the error for various values of $h$ with $k$ fixed and much smaller than the smallest value of $h^2$; see Table \ref{table:euler_space}. These tables are generated by running \verb*|problem1_calculations.m|.
		
		\begin{table}
			\centering
			\begin{tabular}{@{}lllll@{}}
				\toprule
				$k$ & $L^\infty$ error & $L^\infty$ rate & $L^2$ error & $L^2$ rate \\
				\midrule
				
				\bottomrule
			\end{tabular}
			\caption{First-order convergence in time of the forward Euler method. Note that $h^2 = 4k$.}
			\label{table:euler_time}
		\end{table}
		
		
		\begin{table}
			\centering
			\begin{tabular}{@{}lllll@{}}
				\toprule
				$k$ & $L^\infty$ error & $L^\infty$ rate & $L^2$ error & $L^2$ rate \\
				\midrule
				
				\bottomrule
			\end{tabular}
			\caption{Second-order convergence in space of the forward Euler method. Note that $k = \frac{1}{16384}$}
			\label{table:euler_space}
		\end{table}
	\end{alphaparts}
\end{document}