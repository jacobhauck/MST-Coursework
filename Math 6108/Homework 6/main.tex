\documentclass{homework}
\input{../../standardcmd.tex}
\input{../homework_shared.tex}

\newcommand{\hwnum}{6}

\begin{document}
	\maketitle
	
	\question
	
	\question Let $\vec{x}_1,\vec{x}_2, \dots,\vec{x}_n\in\mathbb{R}^n$ be orthonormal. Let $A \in \mathbb{R}^n$. If $A\vec{x}_1, A\vec{x}_2,\dots, A\vec{x}_n$ are also orthonormal, then $A$ is orthogonal.
	
	\begin{proof}
		Let $X = \mat{\vec{x}_1 & \vec{x}_2 & \cdots & \vec{x}_n}$, and let $B = \mat{A\vec{x}_1 & A\vec{x}_2 & \cdots & A\vec{x}_n}$. Then $B = AX$. Since the columns of $B$ and $X$ are orthonormal, they are both orthogonal matrices. Therefore,
		\begin{equation*}
			A = BX^T.
		\end{equation*}
		Since $(BX^T)^T(BX^T) = XB^TBX^T = I$ and $(BX^T)(BX^T)^T = BX^TXB^T = I$ by the orthogonality of $B$ and $X$, it follows that $A$ is invertible with $A^{-1} = (BX^T)^T = A^T$. This implies that $A$ is orthogonal.
	\end{proof}
	
	\question The algorithm for the Gram-Schmidt process is described in Algorithm \ref{alg:gs}. An implementation in Python is provided in Listing \ref{lst:gs}. We note that this implementation detects linear dependence of the columns of $A$ as a part of the Gram-Schmidt process by checking if the produced orthogonal vectors are zero (well, almost zero, to account for numerical rounding error). This is possible because the columns of $A$ are linearly dependent if and only the Gram-Schmidt process produces a zero vector at some point. This is easy to prove.
	
	For $j < i$, each $\vec{b}_j$ is a linear combination of the first $j$ columns of $A$. We can prove this by induction. For the base case, $\vec{b}_1 = \lVert\vec{a}_1\rVert^{-1}\vec{a}_1$. For some $1 \le k < i-1$, suppose for induction that $\vec{b}_j = \sum\limits_{m=1}^jc_{jm}\vec{a}_m$ for $1 \le j \le k$ and some constants $c_{jm}$. Then
	\begin{equation*}
		\vec{b}_{k+1} = \vec{a}_{k+1} - \sum_{p=1}^k \langle\vec{b}_p,\vec{a}_{k+1}\rangle \sum_{m=1}^p c_{pm}\vec{a}_m
	\end{equation*}
	which completes the proof by induction.
	
	Suppose that $\vec{b}_i = \vec{0}$. Then
	\begin{equation*}
		\vec{0} = \vec{b}_i = \vec{a}_i - \sum_{p=1}^{i-1}\langle\vec{b}_p, \vec{a}_i\rangle \sum_{m=1}^pc_{pm}\vec{a}_m.
	\end{equation*}
	The coefficient of $\vec{a}_i$ is non-zero, so a non-trivial linear combination of the columns of $A$ is $\vec{0}$, meaning that the columns of $A$ are linearly dependent.
	
	Conversely, if the columns of $A$ are linearly dependent, then there exists $c_1,\dots, c_m$ not all equal to zero such that
	\begin{equation*}
		\sum_{i=1}^m c_i\vec{a}_i = \vec{0}.
	\end{equation*}
	Let $k$ be the largest integer such that $c_k \ne 0$. Then
	\begin{equation*}
		\vec{0} = \sum_{i=1}^kc_i\vec{a}_i = c_k\vec{b}_k  + \sum_{p=1}^{k-1}\langle\vec{b}_p,\vec{a}_k\rangle\vec{b}_p + \sum_{i=1}^{k-1}\left(c_i\vec{b}_i + c_i\sum_{p=1}^{i-1}\langle\vec{b}_p,\vec{a}_i\rangle\vec{b}_p\right).
	\end{equation*}
	The coefficient of $\vec{b}_k$ is nonzero, so it follows that the columns of $B$ are linearly dependent. Since the columns of $B$ are also orthogonal because of the Gram-Schmidt process, one of them must be zero.
	
	The command \texttt{python -m gs} can be used to run the tests, which verify that the function works across a range of input types that cover every code path. The output from running these tests is given in Listing \ref{lst:gs_output}.
	\begin{algorithm}
		\caption{Gram-Schmidt Orthogonalization}\label{alg:gs}
		\KwIn{Matrix $A \in \mathbb{R}^{n\times m}$ with linearly independent columns $\vec{a}_1, \dots, \vec{a}_m \in \mathbb{R}^n$}
		\KwOut{Matrix $B \in \mathbb{R}^{n\times m}$, whose columns $\vec{b}_1, \dots, \vec{b}_m \in \mathbb{R}^n$ are the orthogonal vectors obtained by applying the Gram-Schmidt process to the columns of $A$}
		$c \gets 1$\;
		\Repeat{$c = n$}{
			$\vec{b}_c \gets \vec{a}_c - \sum\limits_{p=1}^{c-1} \langle \vec{b}_p, \vec{a}_c\rangle\vec{b}_p$ \tcp*{Sum is 0 by convention if $c=1$}
			$\vec{b}_c \gets \frac{\vec{b}_c}{\lVert\vec{b}_c\rVert}$
		}
	\end{algorithm}
	
	\pythonexternal[caption={Python implementation of the Gram-Schmidt process}, label={lst:gs}]{gs.py}
	
	\txtexternal[caption={Output for test cases}, label={lst:gs_output}]{gs_output.txt}
\end{document}